<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Calibrated Ops | Tech Tool</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚙️</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* --- APP STYLING --- */
        :root {
            --bg-color: #0a192f;
            --card-bg: #112240;
            --primary: #00e5ff;
            --danger: #ff5252;
            --success: #00e676;
            --text: #e6f1ff;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text);
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        /* App Header */
        header {
            background: rgba(17, 34, 64, 0.95);
            padding: 15px 20px;
            text-align: center;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 1px;
            font-family: 'Roboto Mono', monospace;
        }

        .home-link {
            text-decoration: none;
            color: var(--primary);
            font-size: 1.5rem;
        }

        /* Tabs */
        .tab-container {
            display: flex;
            background: #020c1b;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: transparent;
            color: #8892b0;
            border: none;
            font-family: 'Roboto Mono', monospace;
            font-weight: 700;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            background: rgba(0, 229, 255, 0.05);
        }

        /* Content Sections */
        .section {
            display: none;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            padding-bottom: 80px; /* Space for scroll */
        }

        .section.active { display: block; }

        /* Inputs */
        .input-group {
            margin-bottom: 15px;
            background: var(--card-bg);
            padding: 10px 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #ccd6f6;
        }

        input[type="number"] {
            background: transparent;
            border: none;
            color: var(--primary);
            font-family: 'Roboto Mono', monospace;
            font-size: 1.2rem;
            text-align: right;
            width: 100px;
            outline: none;
        }
        
        input[type="number"]::placeholder { color: #445; }

        /* Calc Button */
        .action-btn {
            width: 100%;
            padding: 18px;
            margin-top: 20px;
            background: var(--primary);
            color: #0a192f;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Roboto Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 229, 255, 0.3);
        }

        .action-btn:active { transform: scale(0.98); }

        /* Results Box */
        .result-box {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            display: none; /* Hidden by default */
        }

        .lsi-score {
            font-size: 3rem;
            font-weight: 700;
            font-family: 'Roboto Mono', monospace;
            margin: 10px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .lsi-status {
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 0.9rem;
        }

        /* Safety Checklist Styling */
        .checklist-item {
            background: var(--card-bg);
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .checklist-item.checked {
            background: rgba(0, 230, 118, 0.1);
            border-color: var(--success);
        }

        .check-circle {
            width: 24px;
            height: 24px;
            border: 2px solid #8892b0;
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checklist-item.checked .check-circle {
            background: var(--success);
            border-color: var(--success);
            color: #0a192f;
        }

        .checklist-item.checked .check-circle::after {
            content: '✓';
            font-weight: 700;
        }

        .reset-btn {
            background: transparent;
            border: 1px solid var(--danger);
            color: var(--danger);
            margin-top: 30px;
        }

    </style>
</head>
<body>

    <header>
        <h1>CALIBRATED OPS</h1>
        <a href="index.html" class="home-link">✕</a>
    </header>

    <div class="tab-container">
        <button class="tab active" onclick="switchTab('calc')">LSI CALC</button>
        <button class="tab" onclick="switchTab('safety')">SAFETY</button>
    </div>

    <div id="calc" class="section active">
        
        <div class="input-group">
            <label>pH</label>
            <input type="number" id="ph" placeholder="7.5" step="0.1">
        </div>
        <div class="input-group">
            <label>Water Temp (°F)</label>
            <input type="number" id="temp" placeholder="80" value="80">
        </div>
        <div class="input-group">
            <label>Calcium (CH)</label>
            <input type="number" id="ch" placeholder="300" step="10">
        </div>
        <div class="input-group">
            <label>Alkalinity (TA)</label>
            <input type="number" id="ta" placeholder="100" step="10">
        </div>
        <div class="input-group">
            <label>CYA (Stabilizer)</label>
            <input type="number" id="cya" placeholder="50" step="10">
        </div>
        <div class="input-group">
            <label>TDS / Salt</label>
            <input type="number" id="tds" placeholder="1000" step="100">
        </div>

        <button class="action-btn" onclick="calculateLSI()">CALCULATE LSI</button>

        <div id="result" class="result-box">
            <div id="lsi-val" class="lsi-score">0.00</div>
            <div id="lsi-msg" class="lsi-status">BALANCED</div>
            <p id="lsi-desc" style="font-size:0.8rem; margin-top:10px; opacity:0.8;"></p>
        </div>

    </div>

    <div id="safety" class="section">
        <p style="text-align: center; color: #8892b0; font-size: 0.8rem; margin-bottom: 20px;">SITE SAFETY AUDIT</p>
        
        <div id="checklist-container">
            </div>

        <button class="action-btn reset-btn" onclick="resetSafety()">RESET FORM</button>
    </div>

    <script>
        // --- TABS LOGIC ---
        function switchTab(tabId) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // --- LSI CALCULATOR LOGIC ---
        function calculateLSI() {
            // 1. Get Values
            let ph = parseFloat(document.getElementById('ph').value);
            let temp = parseFloat(document.getElementById('temp').value);
            let ch = parseFloat(document.getElementById('ch').value);
            let ta = parseFloat(document.getElementById('ta').value);
            let cya = parseFloat(document.getElementById('cya').value) || 0;
            let tds = parseFloat(document.getElementById('tds').value) || 0;

            if(!ph || !temp || !ch || !ta) {
                alert("Please fill in pH, Temp, Calcium, and Alkalinity.");
                return;
            }

            // 2. Calculate Factors (Standard Pool Industry Approximation)
            
            // Temperature Factor: (TempF * 0.01) - 0.1 is a very close linear approx for pool ranges (60-100F)
            let tf = (temp * 0.01) - 0.1; 
            
            // Calcium Factor: log10(CH) - 0.4 (Approx fit for 200-400 range)
            let cf = Math.log10(ch) - 0.4;
            
            // Alkalinity Factor: log10(Corrected Alk)
            // CYA Correction: Subtract roughly 1/3 of CYA from TA (at standard pH)
            let carbonateAlk = ta - (cya * 0.30);
            if (carbonateAlk < 1) carbonateAlk = 1; // Prevent log errors
            let af = Math.log10(carbonateAlk);
            
            // TDS Penalty: 12.1 is constant, adjust to 12.2 if Salt > 1000
            let tdsFactor = (tds > 1000) ? 12.2 : 12.1;

            // 3. The Formula
            let lsi = ph + tf + cf + af - tdsFactor;
            
            // 4. Display Results
            let resultBox = document.getElementById('result');
            let valDiv = document.getElementById('lsi-val');
            let msgDiv = document.getElementById('lsi-msg');
            let descDiv = document.getElementById('lsi-desc');

            resultBox.style.display = "block";
            valDiv.innerText = lsi.toFixed(2);

            // Color Coding
            if (lsi >= -0.3 && lsi <= 0.3) {
                resultBox.style.backgroundColor = "rgba(0, 230, 118, 0.15)";
                resultBox.style.border = "1px solid #00e676";
                valDiv.style.color = "#00e676";
                msgDiv.innerText = "PERFECTLY BALANCED";
                descDiv.innerText = "Water is neutral. Safe for plaster and equipment.";
            } else if (lsi < -0.3) {
                resultBox.style.backgroundColor = "rgba(255, 82, 82, 0.15)";
                resultBox.style.border = "1px solid #ff5252";
                valDiv.style.color = "#ff5252";
                msgDiv.innerText = "CORROSIVE (ETCHING)";
                descDiv.innerText = "Water is aggressive. It will eat plaster and corrode heater coils. Add Bicarb or Calcium.";
            } else {
                resultBox.style.backgroundColor = "rgba(255, 171, 0, 0.15)";
                resultBox.style.border = "1px solid #ffab00";
                valDiv.style.color = "#ffab00";
                msgDiv.innerText = "SCALE FORMING";
                descDiv.innerText = "Water is depositing calcium. Risk of clogged pipes and rough surfaces. Lower pH.";
            }
        }

        // --- SAFETY CHECKLIST LOGIC ---
        const safetyItems = [
            "Gates are self-closing & self-latching",
            "Gate opens OUTWARD (away from pool)",
            "No gaps > 4 inches under fence",
            "Shepherd's Hook attached to pole",
            "Ring Buoy with throw rope present",
            "Emergency Phone has dial tone",
            "Main Drain covers secure (VGB)",
            "Skimmer baskets intact",
            "No Diving markers visible",
            "Handrails secure (no wobble)"
        ];

        function renderSafety() {
            const container = document.getElementById('checklist-container');
            container.innerHTML = '';
            safetyItems.forEach((item, index) => {
                let div = document.createElement('div');
                div.className = 'checklist-item';
                div.onclick = function() { this.classList.toggle('checked'); };
                div.innerHTML = `
                    <div class="check-circle"></div>
                    <span>${item}</span>
                `;
                container.appendChild(div);
            });
        }

        function resetSafety() {
            document.querySelectorAll('.checklist-item').forEach(el => el.classList.remove('checked'));
        }

        // Initialize
        renderSafety();

    </script>
</body>
</html>
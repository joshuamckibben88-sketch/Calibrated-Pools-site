<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Calibrated Ops | Pro</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öôÔ∏è</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* --- APP STYLING --- */
        :root {
            --bg-color: #0a192f;
            --card-bg: #112240;
            --primary: #00e5ff;
            --secondary: #8892b0;
            --danger: #ff5252;
            --success: #00e676;
            --text: #e6f1ff;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text);
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            padding-bottom: 80px;
            -webkit-font-smoothing: antialiased;
        }

        /* App Header */
        header {
            background: rgba(17, 34, 64, 0.95);
            padding: 15px 20px;
            text-align: center;
            border-bottom: 2px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 { margin: 0; font-size: 1.1rem; font-weight: 700; font-family: 'Roboto Mono', monospace; }
        .home-link { text-decoration: none; color: var(--primary); font-size: 1.5rem; }

        /* Navigation Bar (Bottom) */
        .nav-bar {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #020c1b;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            border-top: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        .nav-item {
            color: #8892b0;
            text-align: center;
            font-size: 0.7rem;
            cursor: pointer;
            flex: 1;
        }

        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 1.2rem; display: block; margin-bottom: 4px; }

        /* Sections */
        .section { display: none; padding: 20px; max-width: 600px; margin: 0 auto; }
        .section.active { display: block; }

        /* Inputs & Cards */
        .input-group {
            margin-bottom: 12px;
            background: var(--card-bg);
            padding: 12px 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.05);
        }

        label { font-size: 0.9rem; font-weight: 600; color: #ccd6f6; }
        
        input, select {
            background: transparent;
            border: none;
            color: var(--primary);
            font-family: 'Roboto Mono', monospace;
            font-size: 1.1rem;
            text-align: right;
            outline: none;
            width: 120px;
        }

        /* Buttons */
        .action-btn {
            width: 100%;
            padding: 16px;
            margin-top: 15px;
            background: var(--primary);
            color: #0a192f;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 700;
            font-family: 'Roboto Mono', monospace;
            text-transform: uppercase;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 229, 255, 0.2);
        }
        
        .copy-btn { background: #64ffda; margin-top: 10px; }
        .copy-btn:active { background: #00bfa5; }

        /* Guide Cards */
        .guide-card {
            background: var(--card-bg);
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        .guide-title { font-weight: 700; color: var(--text); margin-bottom: 5px; display: block; }
        .guide-desc { font-size: 0.85rem; color: #a8b2d1; line-height: 1.5; }
        
        /* Volume Calculator */
        .vol-result {
            text-align: center; font-family: 'Roboto Mono', monospace; 
            font-size: 2rem; color: var(--primary); margin: 20px 0;
        }

        /* LSI Results */
        .result-box {
            margin-top: 25px; padding: 20px; border-radius: 8px; 
            text-align: center; display: none;
        }
        .lsi-score { font-size: 3rem; font-weight: 700; font-family: 'Roboto Mono', monospace; }
        .lsi-status { font-weight: 700; text-transform: uppercase; letter-spacing: 2px; font-size: 0.9rem; }

        /* Safety Items */
        .checklist-item {
            background: var(--card-bg); margin-bottom: 10px; padding: 15px;
            border-radius: 8px; display: flex; align-items: center; cursor: pointer;
        }
        .checklist-item.checked { border: 1px solid var(--success); }
        .check-circle {
            width: 24px; height: 24px; border: 2px solid #8892b0; border-radius: 50%;
            margin-right: 15px; display: flex; align-items: center; justify-content: center;
        }
        .checklist-item.checked .check-circle { background: var(--success); border-color: var(--success); color: #000; }
        .checklist-item.checked .check-circle::after { content: '‚úì'; font-weight: 700; }

    </style>
</head>
<body>

    <header>
        <h1>CALIBRATED OPS</h1>
        <a href="index.html" class="home-link">‚úï</a>
    </header>

    <div id="tab-lsi" class="section active">
        <div class="input-group"><label>pH</label><input type="number" id="ph" placeholder="7.5" step="0.1"></div>
        <div class="input-group"><label>Water Temp (¬∞F)</label><input type="number" id="temp" placeholder="80" value="80"></div>
        <div class="input-group"><label>Calcium (CH)</label><input type="number" id="ch" placeholder="300" step="10"></div>
        <div class="input-group"><label>Alkalinity (TA)</label><input type="number" id="ta" placeholder="100" step="10"></div>
        <div class="input-group"><label>CYA (Stab)</label><input type="number" id="cya" placeholder="50" step="10"></div>
        <div class="input-group"><label>TDS / Salt</label><input type="number" id="tds" placeholder="1000" step="100"></div>

        <button class="action-btn" onclick="calculateLSI()">CALCULATE</button>

        <div id="result" class="result-box">
            <div id="lsi-val" class="lsi-score">0.00</div>
            <div id="lsi-msg" class="lsi-status">BALANCED</div>
            <p id="lsi-desc" style="font-size:0.8rem; margin:10px 0; opacity:0.8;"></p>
            
            <button class="action-btn copy-btn" onclick="copyReport()">üìã COPY REPORT FOR TEXT</button>
        </div>
    </div>

    <div id="tab-safety" class="section">
        <p style="text-align: center; color: #8892b0; font-size: 0.8rem; margin-bottom: 20px;">SITE SAFETY AUDIT</p>
        <div id="checklist-container"></div>
        <button class="action-btn" style="background:transparent; border:1px solid var(--danger); color:var(--danger)" onclick="resetSafety()">RESET FORM</button>
    </div>

    <div id="tab-vol" class="section">
        <div class="input-group">
            <label>Shape</label>
            <select id="pool-shape" style="text-align:right;">
                <option value="rect">Rectangle</option>
                <option value="round">Round</option>
                <option value="kidney">Kidney/Oval</option>
            </select>
        </div>
        <div class="input-group"><label>Length (ft)</label><input type="number" id="len"></div>
        <div class="input-group"><label>Width (ft)</label><input type="number" id="wid"></div>
        <div class="input-group"><label>Avg Depth (ft)</label><input type="number" id="depth"></div>
        
        <button class="action-btn" onclick="calcVolume()">CALCULATE GALLONS</button>
        <div id="vol-display" class="vol-result">0 gal</div>
    </div>

    <div id="tab-guide" class="section">
        <h3 style="color:var(--primary); margin-bottom:20px;">DIAGNOSTIC CHEAT SHEET</h3>
        
        <div class="guide-card" style="border-color: #00e676;">
            <span class="guide-title">GREEN ALGAE</span>
            <div class="guide-desc">Free floating, clouds water fast.<br><strong>Fix:</strong> Brush walls, double shock (chlorine), clean filter.</div>
        </div>
        
        <div class="guide-card" style="border-color: #ffeb3b;">
            <span class="guide-title">MUSTARD (YELLOW) ALGAE</span>
            <div class="guide-desc">Clings to walls (shade side), looks like pollen.<br><strong>Fix:</strong> Very chlorine resistant. Needs "Yellow Out" (Sodium Bromide) + High Chlorine.</div>
        </div>

        <div class="guide-card" style="border-color: #212121;">
            <span class="guide-title">BLACK ALGAE</span>
            <div class="guide-desc">Pinhead sized spots, has roots into plaster.<br><strong>Fix:</strong> Use Stainless Steel brush to break heads. Rub with Trichlor tab. Shock heavily.</div>
        </div>

        <div class="guide-card" style="border-color: #e0f7fa;">
            <span class="guide-title">CLOUDY WATER</span>
            <div class="guide-desc">
                <strong>1. Filtration:</strong> Check pressure. Backwash if >10psi over clean.<br>
                <strong>2. Chemistry:</strong> High pH/Alk can cause calcium clouding.<br>
                <strong>3. Early Algae:</strong> Water looks "dull" before turning green. Shock it.
            </div>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="switchTab('tab-lsi', this)">
            <span class="nav-icon">‚öóÔ∏è</span>CHEMISTRY
        </div>
        <div class="nav-item" onclick="switchTab('tab-safety', this)">
            <span class="nav-icon">üõ°Ô∏è</span>SAFETY
        </div>
        <div class="nav-item" onclick="switchTab('tab-vol', this)">
            <span class="nav-icon">üìè</span>VOLUME
        </div>
        <div class="nav-item" onclick="switchTab('tab-guide', this)">
            <span class="nav-icon">üìñ</span>GUIDE
        </div>
    </div>

    <script>
        // --- NAVIGATION ---
        function switchTab(tabId, el) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            if(el) el.classList.add('active');
        }

        // --- LSI & REPORT LOGIC ---
        function calculateLSI() {
            let ph = parseFloat(document.getElementById('ph').value);
            let temp = parseFloat(document.getElementById('temp').value);
            let ch = parseFloat(document.getElementById('ch').value);
            let ta = parseFloat(document.getElementById('ta').value);
            let cya = parseFloat(document.getElementById('cya').value) || 0;
            let tds = parseFloat(document.getElementById('tds').value) || 0;

            if(!ph || !temp || !ch || !ta) { alert("Enter basic readings first."); return; }

            let tf = (temp * 0.01) - 0.1;
            let cf = Math.log10(ch) - 0.4;
            let carbonateAlk = ta - (cya * 0.30);
            if (carbonateAlk < 1) carbonateAlk = 1;
            let af = Math.log10(carbonateAlk);
            let tdsFactor = (tds > 1000) ? 12.2 : 12.1;

            let lsi = ph + tf + cf + af - tdsFactor;
            
            let resultBox = document.getElementById('result');
            let valDiv = document.getElementById('lsi-val');
            let msgDiv = document.getElementById('lsi-msg');
            let descDiv = document.getElementById('lsi-desc');

            resultBox.style.display = "block";
            valDiv.innerText = lsi.toFixed(2);

            if (lsi >= -0.3 && lsi <= 0.3) {
                valDiv.style.color = "#00e676"; msgDiv.innerText = "BALANCED";
                descDiv.innerText = "Water is perfect.";
            } else if (lsi < -0.3) {
                valDiv.style.color = "#ff5252"; msgDiv.innerText = "CORROSIVE";
                descDiv.innerText = "Risk of etching. Add Bicarb.";
            } else {
                valDiv.style.color = "#ffab00"; msgDiv.innerText = "SCALE FORMING";
                descDiv.innerText = "Risk of scale. Lower pH.";
            }
        }

        function copyReport() {
            let ph = document.getElementById('ph').value;
            let ch = document.getElementById('ch').value;
            let ta = document.getElementById('ta').value;
            let lsi = document.getElementById('lsi-val').innerText;
            let status = document.getElementById('lsi-msg').innerText;
            let date = new Date().toLocaleDateString();

            let report = `SERVICE LOG - ${date}\nStatus: ${status} (LSI: ${lsi})\n\nREADINGS:\npH: ${ph}\nAlk: ${ta}\nCalc: ${ch}\n\nWater balanced to LSI standards.\n- Calibrated Pools`;

            navigator.clipboard.writeText(report).then(() => {
                alert("Report copied! Open text messages and paste.");
            });
        }

        // --- VOLUME CALCULATOR ---
        function calcVolume() {
            let shape = document.getElementById('pool-shape').value;
            let len = parseFloat(document.getElementById('len').value) || 0;
            let wid = parseFloat(document.getElementById('wid').value) || 0;
            let depth = parseFloat(document.getElementById('depth').value) || 0;
            let vol = 0;

            if (shape === 'rect') { vol = len * wid * depth * 7.5; }
            else if (shape === 'round') { vol = 3.14 * (len/2) * (len/2) * depth * 7.5; } // Use Length as Diameter
            else { vol = len * wid * depth * 7.0; } // Kidney avg

            document.getElementById('vol-display').innerText = Math.round(vol).toLocaleString() + " gal";
        }

        // --- SAFETY INIT ---
        const safetyItems = [
            "Gates self-closing & self-latching", "Gate opens OUTWARD", "No gaps > 4 inches under fence",
            "Shepherd's Hook on pole", "Ring Buoy with rope", "Emerg. Phone dial tone",
            "Main Drain covers secure", "Skimmer baskets intact", "No Diving markers", "Handrails secure"
        ];
        const sContainer = document.getElementById('checklist-container');
        safetyItems.forEach(i => {
            let d = document.createElement('div'); d.className = 'checklist-item';
            d.onclick = function() { this.classList.toggle('checked'); };
            d.innerHTML = `<div class="check-circle"></div><span>${i}</span>`;
            sContainer.appendChild(d);
        });
        function resetSafety() { document.querySelectorAll('.checklist-item').forEach(el => el.classList.remove('checked')); }

    </script>
</body>
</html>
